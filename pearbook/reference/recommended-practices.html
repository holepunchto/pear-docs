<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Pear Docs</title>
<meta content="width=device-width, initial-scale=1" name="viewport">
<link rel="icon" type="image/png" sizes="96x96" href="/assets/favicon-96x9x.svg">
<link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
<link rel="shortcut icon" href="/assets/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">
<link rel="manifest" href="/assets/site.webmanifest">
<link href="/assets/index.css" rel="stylesheet">
</head>
<body>
<header class="site-header"><label class="site-header__button" id="table-of-contents-toggle-button" for="table-of-contents-toggle" type="button" aria-label="Open table of contents" aria-pressed="false" data-active="false" data-state="closed"><svg class="site-header__button-icon" style="mask-image:url(/assets/bars.svg);-webkit-mask-image:url(/assets/bars.svg);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor"></svg></label><a href="/"><img alt="logo" src="/assets/pear-vector.svg"></a><div class="site-header__right"><div class="color-scheme-toggle"><button class="color-scheme-toggle__button" onclick="toggleColorScheme()"><div class="color-scheme-toggle__circle"></div></button></div></div></header><div class="site-container"><input id="table-of-contents-toggle" name="table-of-contents-toggle" type="checkbox"><aside class="table-of-contents" id="table-of-contents"><ul>
<li><a href="/index.html">Pear by Holepunch</a></li>
</ul>
<h3>Reference</h3>
<ul>
<li><a href="/reference/cli.html">Pear CLI</a></li>
<li><a href="/reference/configuration.html">Pear Application Configuration</a></li>
<li><a href="/reference/bare-overview.html">Bare Overview</a></li>
<li><a href="/reference/api.html">API</a></li>
<li><a href="/reference/templates.html">Templates</a></li>
<li><a href="/reference/node-compat.html">Node.js Compatibility</a></li>
<li><a href="/reference/recommended-practices.html">Recommended Practices</a></li>
<li><a href="/reference/troubleshooting.html">Troubleshooting</a></li>
<li><a href="/reference/faq.html">Frequently Asked Questions</a></li>
<li><a href="/reference/migration.html">Migration</a></li>
</ul>
<h3>Guides</h3>
<ul>
<li><a href="/guide/getting-started.html">Getting Started</a></li>
<li><a href="/guide/starting-a-pear-desktop-project.html">Starting a Pear Desktop Project</a></li>
<li><a href="/guide/making-a-pear-desktop-app.html">Making a Pear Desktop Application</a></li>
<li><a href="/guide/starting-a-pear-terminal-project.html">Starting a Pear Terminal Project</a></li>
<li><a href="/guide/making-a-pear-terminal-app.html">Making a Pear Terminal Application</a></li>
<li><a href="/guide/sharing-a-pear-app.html">Sharing a Pear Application</a></li>
<li><a href="/guide/releasing-a-pear-app.html">Releasing a Pear Application</a></li>
<li><a href="/guide/making-a-bare-mobile-app.html">Making a Bare Mobile Application</a></li>
<li><a href="/guide/debugging-a-pear-terminal-app.html">Debugging a Pear Terminal Application</a></li>
<li><a href="/guide/creating-a-pear-init-template.html">Creating a <code>pear init</code> Template</a></li>
</ul>
<h3>How-tos</h3>
<ul>
<li><a href="/howto/connect-two-peers-by-key-with-hyperdht.html">Connect two peers</a></li>
<li><a href="/howto/connect-to-many-peers-by-topic-with-hyperswarm.html">Connect many peers</a></li>
<li><a href="/howto/replicate-and-persist-with-hypercore.html">Replicate &#x26; persist</a></li>
<li><a href="/howto/work-with-many-hypercores-using-corestore.html">Manage multiple Hypercores</a></li>
<li><a href="/howto/share-append-only-databases-with-hyperbee.html">Share append-only databases</a></li>
<li><a href="/howto/create-a-full-peer-to-peer-filesystem-with-hyperdrive.html">Create a p2p filesystem</a></li>
</ul>
<h3>Pear Modules</h3>
<ul>
<li><a href="/index.html#application-libraries">Application Libraries</a></li>
<li><a href="/index.html#user-interface-libraries">User Interface Libraries</a></li>
<li><a href="/index.html#common-libraries">Common Libraries</a></li>
<li><a href="/index.html#developer-libraries">Developer Libraries</a></li>
<li><a href="/index.html#integration-libraries">Integration Libraries</a></li>
</ul>
<h3>P2P Modules</h3>
<ul>
<li><a href="/index.html#building-blocks">Building-Block Libraries</a></li>
<li><a href="/index.html#helpers">Helper Libraries</a></li>
</ul>
<h3>Building blocks</h3>
<ul>
<li><a href="/building-blocks/hypercore.html">Hypercore</a></li>
<li><a href="/building-blocks/hyperbee.html">Hyperbee</a></li>
<li><a href="/building-blocks/hyperdrive.html">Hyperdrive</a></li>
<li><a href="/building-blocks/autobase.html">Autobase</a></li>
<li><a href="/building-blocks/hyperdht.html">HyperDHT</a></li>
<li><a href="/building-blocks/hyperswarm.html">Hyperswarm</a></li>
</ul>
<h3>Helpers</h3>
<ul>
<li><a href="/helpers/corestore.html">Corestore</a></li>
<li><a href="/helpers/localdrive.html">Localdrive</a></li>
<li><a href="/helpers/mirrordrive.html">Mirrordrive</a></li>
<li><a href="/helpers/secretstream.html">Secretstream</a></li>
<li><a href="/helpers/compact-encoding.html">Compact encoding</a></li>
<li><a href="/helpers/protomux.html">Protomux</a></li>
</ul>
<h3>Bare Modules</h3>
<ul>
<li><a href="/index.html#bare-modules">Standard Libraries</a></li>
</ul>
<h3>Tools</h3>
<ul>
<li><a href="/index.html#tools">Tool List</a></li>
<li><a href="/tools/hypershell.html">Hypershell</a></li>
<li><a href="/tools/hypertele.html">Hypertele</a></li>
<li><a href="/tools/hyperbeam.html">Hyperbeam</a></li>
<li><a href="/tools/hyperssh.html">Hyperssh</a></li>
<li><a href="/tools/drives.html">Drives</a></li>
</ul>
<h3>Examples</h3>
<ul>
<li><a href="https://github.com/holepunchto/pear/tree/main/examples/terminal">Pear Terminal</a></li>
<li><a href="https://github.com/holepunchto/pear/tree/main/examples/desktop">Pear Desktop (Electron)</a></li>
<li><a href="https://github.com/holepunchto/bare-android">Bare Android</a></li>
<li><a href="https://github.com/holepunchto/bare-ios">Bare iOS</a></li>
</ul></aside><main class="site-content"><div class="heading-link"><a href="#recommended-practices"><h1>#</h1></a><h1 id="recommended-practices">Recommended Practices</h1></div>
<p>This article covers useful patterns that one should follow in most cases when
developing Pear applications.</p>
<div class="heading-link"><a href="#use-one-corestore-instance-per-application"><h2>#</h2></a><h2 id="use-one-corestore-instance-per-application">Use One Corestore Instance Per Application</h2></div>
<p>Corestores are meant to manage many cores and their sessions efficiently. Having multiple Corestore instances can cause issues such as file locking errors when using the same storage and duplicate core storage if the same core is used by two Corestores with different storages.</p>
<p>A single Corestore instance will:</p>
<ul>
<li>Reduces open file handles.</li>
<li>Reduces storage space by deduping hypercore storage.</li>
<li>Requires only one replication stream per peer.</li>
</ul>
<p>If using <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>name</span></span></code></span>d cores that collide across different components of an app is an issue, use namespaces (<span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>store.namepace('a')</span></span></code></span>) to create a namespaced version of a Corestore. Note that retrieving cores by <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>key</span></span></code></span> are unaffected by namespacing.</p>
<div class="heading-link"><a href="#use-one-hyperswarm-instance-per-application"><h2>#</h2></a><h2 id="use-one-hyperswarm-instance-per-application">Use One Hyperswarm Instance Per Application</h2></div>
<p>Hyperswarm supports joining multiple topics on the same instance and will dedup peer connections shared between them. Having only one swarm instance will speed up connections by reducing records in the DHT for the topic and simplify managing the max number of connections an app makes.</p>
<div class="heading-link"><a href="#never-load-javascript-over-https"><h2>#</h2></a><h2 id="never-load-javascript-over-https">Never Load Javascript Over HTTP(S)</h2></div>
<p>Just like in web development, running code from an external source is dangerous. Running external code opens an application up to being exploited if the external source is nefarious or compromised. This is why http and https traffic is blocked by default in Pear applications, preventing unintentional loading of code that would make your application vulnerable to supply chain attacks. This is especially dangerous for applications, like Pear applications, that have access to native functionality (eg. the file system).</p>
<div class="heading-link"><a href="#exclude-development-dependencies-when-staging-applications"><h2>#</h2></a><h2 id="exclude-development-dependencies-when-staging-applications">Exclude Development Dependencies when staging applications</h2></div>
<p>When staging an application, all files in the root directory that are not explicitly ignored will be included in the application bundle. Development dependencies are not required at runtime and should therefore be excluded to reduce bundle size and improve performance. To remove them before staging, run:</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="plaintext" data-theme="github-dark github-light"><code data-language="plaintext" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span>npm prune --omit=dev</span></span></code></pre></figure>
<p>This ensures that only the necessary production dependencies are included in the final bundle.</p>
<div class="heading-link"><a href="#exclude-the-.git-directory"><h2>#</h2></a><h2 id="exclude-the-.git-directory">Exclude the .git Directory</h2></div>
<p>The <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>.git</span></span></code></span> directory is excluded by default. However, if a custom <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>ignore</span></span></code></span> field is defined in the application's <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>stage</span></span></code></span> configuration, this overrides the default ignore rules. In such cases, you must explicitly include <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>.git</span></span></code></span> in the ignore list to ensure it remains excluded.</p></main></div><script type="module" src="/assets/index.js"></script>
</body>
</html>
